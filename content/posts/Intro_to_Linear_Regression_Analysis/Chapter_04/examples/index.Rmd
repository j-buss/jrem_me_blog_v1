---
title: Model Adequacy Checking - Examples from Montgomery/Peck/Vining
author: Jeremy Buss
date: '2021-10-23'
slug: []
categories:
  - Introduction to Linear Regression Analysis - Montgomery/Peck/Vining
  - Applied Stats
  - Regression Analysis
tags:
  - R
  - linear regression
draft: true
katex: yes
---
```{r echo=FALSE}
library(blogdown)
```

For the example data we will leverage the CRAN package "MPV".

```{r}
install.packages("MPV")
library(MPV)
```


# Example 4.1: The Delivery Time Data

Let's define the dataframe for the SoftDrink data and take a look at the first 5 rows:

```{r}
SoftDrink <- data.frame(MPV::softdrink)
colnames(SoftDrink) <- c("DeliveryTime", "NumberCases", "Distance")
head(SoftDrink, 5)
```

With the data ready we will create a multivariate linear model and store the summary in the variable _SoftDrink.lm.sum_ : 

```{r}
SoftDrink.lm <- lm(DeliveryTime ~ NumberCases + Distance, data=SoftDrink)
print(SoftDrink.lm$coefficients)
```


So we see that our equation is: 

DeliverTime = `r SoftDrink.lm$coefficients[1]` + `r SoftDrink.lm$coefficients[2]` x #ofCases + `r SoftDrink.lm$coefficients[3]` x Distance

With the question in had, let's figure out some of the resdiuals

## Residual ("vanilla")

The basic, run o' the mill residuals 

$$
e_i = y_i - \hat{y}_i
$$

are available directly from the linear regression model:

```{r}
SoftDrink.lm.residuals <- SoftDrink.lm$residuals
head(SoftDrink.lm.residuals,5)
```

## Standardized Residuals

For the standardized Residuals we use the basic residuals and divide by the square root of Mean Square Residual:

$$
d_i = \frac{e_i}{\sqrt{MS_{Res}}}
$$

In r this becomes:

```{r}
SoftDrink.lm.MS_res <- SoftDrink.lm.sum$sigma^2
SoftDrink.lm.StandardizedResiduals <- SoftDrink.lm.residuals / sqrt(SoftDrink.lm.MS_res)
head(SoftDrink.lm.StandardizedResiduals,5)
```

## Studentized Residuals 
